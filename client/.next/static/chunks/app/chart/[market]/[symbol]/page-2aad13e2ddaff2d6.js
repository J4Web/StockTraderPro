(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[452],{5871:function(e,t,r){Promise.resolve().then(r.bind(r,4083))},4083:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return C}});var o=r(7437),n=r(2265),a=r(4033),i=r(8989),s=r(8874),l=r(6507),d=r(3226),c=r(1023),u=()=>{let[e,t]=(0,n.useState)(new Date);(0,n.useEffect)(()=>{let e=setInterval(()=>{let e=new Date;t(e)},1e3);return()=>{clearInterval(e)}},[]);let r=e.toLocaleTimeString("en-US",{timeZone:"Asia/Kolkata",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0}).slice(0,-2),a=e.toLocaleTimeString("en-US",{hour12:!0}).slice(-2);return(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,o.jsx)("div",{style:{width:"5rem",letterSpacing:"0.5px"},suppressHydrationWarning:!0,children:r}),(0,o.jsx)("div",{children:a})]})},g=r(7424),p=r(9193);let b=["7 D","10 D","20 D","30 D"],x={background:"rgba( 255, 255, 255, 0.08 )",border:"1px solid rgba( 255, 255, 255, 0.10 )",borderRadius:"1rem",textAlign:"center",fontWeight:600,p:1,px:2,mx:1,cursor:"pointer","&:hover":{background:"rgba(144, 202, 249, 0.15)"}},h=(e,t)=>({...x,background:e?"rgba( 255, 255, 255, 0.20 )":x.background,cursor:t?"not-allowed":"pointer",opacity:t?.5:1});var m=e=>{let{onDaySelect:t,onHighlighted:r,marketStatus:a,dataType:i}=e,[c,u]=(0,n.useState)("historical"===i?b[0]:""),g=e=>{let o=e.currentTarget.innerText.trim();u(o),t(o),r(!0)};return(0,o.jsxs)(s.ZP,{item:!0,sm:12,xs:12,sx:{backgroundColor:"rgb(21, 25, 36, 0.8)",border:"1px solid rgba( 255, 255, 255, 0.10 )",borderRadius:2,display:"flex",alignItems:"center",justifyContent:{xs:"center",sm:"flex-start"},flexDirection:{xs:"column-reverse",sm:"row"},mt:{xs:2,sm:1},p:1.5,order:{xs:1,sm:2}},children:[(0,o.jsx)(l.Z,{sx:{width:{xs:"90%",sm:"18%"},mt:{xs:1,sm:0}},children:(0,o.jsx)(d.Z,{variant:"body2",sx:x,children:"open"===a||"historical"!==i?"Showing Intraday Data":"Showing Last ".concat(c.slice(0,-1)," Days Data")})}),(0,o.jsx)(l.Z,{sx:{display:"flex"},children:b.map(e=>(0,o.jsx)(d.Z,{variant:"body2",sx:h(e===c,"closed"!==a),onClick:"closed"===a?g:void 0,children:e},e))})]})},f=r(4629);let y="#b2b5be",k="#089981",S="#F23645",v=(e,t)=>t>e?k:t<e?S:y,j=e=>e.data.candles.map(e=>({time:new Date(e[0]).getTime()/1e3,open:e[1],high:e[2],low:e[3],close:e[4]})),w=e=>e.ts&&null!==e.open&&null!==e.high&&null!==e.low&&null!==e.close?{time:new Date(parseInt(e.ts)).getTime()/1e3,open:e.open,high:e.high,low:e.low,close:e.close}:(console.error("transformSingleDataToPoint Invalid data point:",e),null),D={open:0,high:0,low:0,close:0},F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var C=()=>{let[e,t]=(0,n.useState)(null),[r,b]=(0,n.useState)(null),[x,h]=(0,n.useState)(y),[C,Z]=(0,n.useState)(D),[T,P]=(0,n.useState)(D),[W,M]=(0,n.useState)(!1),[R,I]=(0,n.useState)(y),[L,A]=(0,n.useState)(0),[N,E]=(0,n.useState)(!1),O=(0,n.useRef)(null),_=(0,a.useParams)();(0,a.usePathname)();let{data:z,refetch:H}=(0,f.L7)(_),U=(0,c.I0)(),{marketStatus:V,dataType:q}=(0,c.v9)(e=>e.stock),[G,{data:J}]=(0,f.P1)(),B=e=>{if(e.seriesData&&e.seriesData.has(r)){let t=e.seriesData.get(r);t?(P({open:t.open,high:t.high,low:t.low,close:t.close}),I(v(t.open,t.close)),M(!0)):(P(C),M(!1))}},K=(e,t)=>{let r=j(e).reverse();t.setData(r);let o=r[r.length-1],n=r[r.length-2];(null==n?void 0:n.close)&&A(null==n?void 0:n.close),o&&(Z({open:o.open,high:o.high,low:o.low,close:o.close}),h(v(o.open,o.close)))},Q=()=>{if(O.current){if(e)e.timeScale().applyOptions({timeVisible:!0,secondsVisible:!1,barSpacing:10,tickMarkFormatter:e=>{let t=new Date(1e3*e),r=F[t.getMonth()];return"historical"===q||N?"".concat(t.getDate().toString().padStart(2,"0")," ").concat(r):"".concat(t.getHours().toString().padStart(2,"0"),":").concat(t.getMinutes().toString().padStart(2,"0"))}});else{let e=(0,i.C2)(O.current,{layout:{background:{type:i.Mr.Solid,color:"#151924"},textColor:y},grid:{vertLines:{color:"#232632"},horzLines:{color:"#232632"}},localization:{priceFormatter:e=>"₹".concat(e.toFixed(2)),timeFormatter:e=>{let t=new Date(1e3*e);return"".concat(t.getHours().toString().padStart(2,"0"),":").concat(t.getMinutes().toString().padStart(2,"0"))}}});e.timeScale().applyOptions({timeVisible:!0,secondsVisible:!1,barSpacing:10,tickMarkFormatter:e=>{let t=new Date(1e3*e),r=F[t.getMonth()];return"historical"===q||N?"".concat(t.getDate().toString().padStart(2,"0")," ").concat(r):"".concat(t.getHours().toString().padStart(2,"0"),":").concat(t.getMinutes().toString().padStart(2,"0"))}});let r=e.addCandlestickSeries({upColor:k,downColor:S,borderDownColor:S,borderUpColor:k,wickDownColor:S,wickUpColor:k});t(e),b(r)}}};(0,n.useEffect)(()=>{let t=J||z;return t&&(t.marketStatus&&t.marketStatus!==V&&U((0,p.u3)(t.marketStatus)),t.type&&t.type!==q&&U((0,p.oO)(t.type))),r&&(N&&J?K(J,r):z&&K(z,r),null==e||e.subscribeCrosshairMove(e=>{e.point&&e.seriesData&&e.seriesData.has(r)?(M(!0),B(e)):M(!1)}),null==e||e.timeScale().fitContent()),g.W.connect(),g.W.on("marketStatusChange",e=>{H()}),(null==z?void 0:z.marketStatus)!==null&&(null==z?void 0:z.marketStatus)!=="closed"&&(g.W.emit("selectSymbol",_.symbol),g.W.on("symbolData",e=>{if(e&&"live_feed"===e.type){var t,o,n,a;let i=Object.keys(e.feeds||{})[0];if(!i){console.log("No valid stock key found");return}let s=null===(a=e.feeds[i])||void 0===a?void 0:null===(n=a.ff)||void 0===n?void 0:null===(o=n.marketFF)||void 0===o?void 0:null===(t=o.marketOHLC)||void 0===t?void 0:t.ohlc;if(s){let e=s.filter(e=>"I1"===e.interval);A(C.close);let t=e[1],o=e[0];if(o&&A(o.close),t&&r){let e=w(t);null==r||r.update(e)}Z({open:t.open,high:t.high,low:t.low,close:t.close}),t.close>t.open?h(k):t.close<t.open?h(S):h(y)}}})),()=>{g.W.disconnect(),e&&(null==e||e.unsubscribeCrosshairMove(B))}},[z,e,r,J]),(0,n.useEffect)(()=>{q&&V&&Q()},[q,V,U]);let X=(C.close-L)/L*100,Y=C.close-L;return(0,n.useEffect)(()=>{let e=X>0?"+":"",t="".concat(_.market," : ").concat(_.symbol," (").concat(e).concat(X.toFixed(2),"%)");return document.title=t,document.body.style.backgroundColor="red !important",()=>{document.title="Stock Trading Platform"}},[X]),(0,o.jsxs)(s.ZP,{container:!0,sx:{mt:8},children:[(0,o.jsx)(s.ZP,{item:!0,xs:12,sm:8,sx:{ml:.2},children:(0,o.jsx)(l.Z,{className:"chartWrapper",children:(0,o.jsx)(l.Z,{ref:O,sx:{width:"100%",height:"20rem",minHeight:{xs:"60vh",sm:"80vh"},overflow:"hidden",position:"relative"},children:(0,o.jsxs)(l.Z,{className:"ohlcInfo",display:"flex",gap:2,sx:{background:"#151924",position:"absolute",top:10,zIndex:10,ml:1},children:[(0,o.jsxs)(d.Z,{variant:"body2",children:["Open:"," ",(0,o.jsx)("span",{style:{color:W?R:x},children:W?T.open.toFixed(2):C.open.toFixed(2)})]}),(0,o.jsxs)(d.Z,{variant:"body2",children:["High:"," ",(0,o.jsx)("span",{style:{color:W?R:x},children:W?T.high.toFixed(2):C.high.toFixed(2)})]}),(0,o.jsxs)(d.Z,{variant:"body2",children:["Low:"," ",(0,o.jsx)("span",{style:{color:W?R:x},children:W?T.low.toFixed(2):C.low.toFixed(2)})]}),(0,o.jsxs)(d.Z,{variant:"body2",children:["Close:"," ",(0,o.jsx)("span",{style:{color:W?R:x},children:W?T.close.toFixed(2):C.close.toFixed(2)})]})]})})})}),(0,o.jsxs)(s.ZP,{item:!0,style:{flexGrow:1},sx:{mx:2,my:{xs:2,sm:0},backdropFilter:"blur(0.5rem)",transition:"backgroundColor 0.5s",borderRadius:"1rem",height:"fit-content",order:{xs:2,sm:1}},children:[(0,o.jsxs)(s.ZP,{item:!0,sx:{backgroundColor:"rgb(21, 25, 36, 0.8)",border:"1px solid rgba( 255, 255, 255, 0.10 )",backdropFilter:"blur(5px)",borderRadius:"1rem",p:3.5,mb:2},children:[(0,o.jsxs)(d.Z,{variant:"h6",sx:{background:"rgba( 255, 255, 255, 0.05 )",border:"1px solid rgba( 255, 255, 255, 0.10 )",backdropFilter:"blur(5px)",textAlign:"center",borderRadius:"1rem",mb:2,padding:1,fontFamily:"inherit"},children:[_.market," : ",_.symbol]}),(0,o.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,o.jsxs)(d.Z,{variant:"body2",sx:{background:"rgba( 255, 255, 255, 0.03 )",border:"1px solid rgba(255, 255, 255, 0.10)",backdropFilter:"blur(5px)",textAlign:"center",borderRadius:"1rem",padding:1,px:2,fontWeight:"600",fontFamily:"inherit",fontSize:{xs:"0.8rem",sm:""}},children:["Today ",new Date().toDateString()]}),(0,o.jsx)(d.Z,{variant:"body2",component:"div",sx:{background:"rgba( 255, 255, 255, 0.03 )",border:"1px solid rgba(255, 255, 255, 0.10)",backdropFilter:"blur(5px)",textAlign:"center",borderRadius:"1rem",padding:1,px:2,fontWeight:"600",fontFamily:"inherit",fontSize:{xs:"0.8rem",sm:""}},children:(0,o.jsx)(u,{})})]}),(0,o.jsxs)(l.Z,{sx:{background:"rgba( 255, 255, 255, 0.03 )",border:"1px solid rgba(255, 255, 255, 0.10)",backdropFilter:"blur(5px)",borderRadius:"1rem",display:"flex",justifyContent:"center",alignItems:"center"},children:[(0,o.jsx)(d.Z,{sx:{textTransform:"capitalize",fontFamily:"inherit",fontWeight:"600",fontSize:{xs:"0.8rem",sm:""}},children:"Market"}),(0,o.jsx)(l.Z,{className:"open"===V?"blob":"blob_closed"}),(0,o.jsx)(d.Z,{sx:{textTransform:"capitalize",fontFamily:"inherit",fontWeight:"600",fontSize:{xs:"0.8rem",sm:""}},children:V})]})]}),(0,o.jsxs)(l.Z,{sx:{backgroundColor:"rgb(21, 25, 36, 0.8)",border:"1px solid rgba( 255, 255, 255, 0.10 )",backdropFilter:"blur(5px)",borderRadius:"1rem",p:3.5},children:[(0,o.jsxs)(d.Z,{variant:"body2",sx:{background:"rgba( 255, 255, 255, 0.03 )",border:"1px solid rgba( 255, 255, 255, 0.10 )",textAlign:"left",borderRadius:"1rem",my:2,padding:1,fontWeight:"600"},children:["Latest Value: ₹",Number(C.close).toFixed(2)]}),(0,o.jsxs)(d.Z,{variant:"body2",sx:{background:"rgba( 255, 255, 255, 0.03 )",border:"1px solid rgba( 255, 255, 255, 0.10 )",textAlign:"left",borderRadius:"1rem",mb:2,padding:1,fontWeight:"600"},children:["Last Value: ₹",Number(L).toFixed(2)]}),(0,o.jsxs)(d.Z,{variant:"body2",sx:{background:"rgba( 255, 255, 255, 0.03 )",border:"1px solid rgba( 255, 255, 255, 0.10 )",textAlign:"left",borderRadius:"1rem",mb:2,padding:1,fontWeight:"600"},children:["Price Change:"," ",(0,o.jsxs)("span",{style:{color:Y<0?S:k},children:["₹ ",Y>0?"+":"",Y.toFixed(2)]})]}),(0,o.jsxs)(d.Z,{variant:"body2",sx:{background:"rgba( 255, 255, 255, 0.03 )",border:"1px solid rgba( 255, 255, 255, 0.10 )",textAlign:"left",borderRadius:"1rem",mb:2,padding:1,fontWeight:"600"},children:["Percentage Change:"," ",(0,o.jsxs)("span",{style:{color:X<0?S:k},children:[X>0?"+":"",X.toFixed(2),"%"]})]})]})]}),(0,o.jsx)(m,{onDaySelect:e=>{let t=_.symbol;G({symbol:t,day:e})},onHighlighted:e=>{E(e)},marketStatus:V,dataType:q})]})}},7424:function(e,t,r){"use strict";r.d(t,{W:function(){return a}});var o=r(3388),n=r(2601);let a=(0,o.io)("".concat(n.env.NEXT_PUBLIC_BACKEND_URL),{autoConnect:!1,withCredentials:!0})},4629:function(e,t,r){"use strict";r.d(t,{L7:function(){return i},P1:function(){return s},nD:function(){return a}});var o=r(8324),n=r(2967);let a=(0,o.LC)({reducerPath:"stockApi",baseQuery:(0,n.ni)({baseUrl:"https://stocktraderpro.onrender.com/api"}),tagTypes:["stocks","history"],endpoints:e=>({getStockData:e.query({query:e=>{let{market:t,symbol:r}=e;return{url:"/intraday/".concat(r),method:"GET"}},providesTags:["stocks"]}),getOnSelecteStockData:e.query({query:e=>{let{symbol:t,day:r}=e;return{url:"/historical/".concat(t,"/").concat(r),method:"GET"}},providesTags:["history"]})})}),{useGetStockDataQuery:i,useLazyGetOnSelecteStockDataQuery:s}=a},9193:function(e,t,r){"use strict";r.d(t,{oO:function(){return i},u3:function(){return a}});var o=r(4302);let n=(0,o.oM)({name:"stock",initialState:{marketStatus:"",dataType:null},reducers:{setMarketStatus:(e,t)=>{t.payload!==e.marketStatus&&(e.marketStatus=t.payload)},setDataType:(e,t)=>{t.payload!==e.dataType&&(e.dataType=t.payload)}}}),{setMarketStatus:a,setDataType:i}=n.actions;t.ZP=n}},function(e){e.O(0,[965,14,38,324,989,971,596,744],function(){return e(e.s=5871)}),_N_E=e.O()}]);